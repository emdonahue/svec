#!/bin/zsh


case "$1" in

    join) #Joins values with the same coordinates together for further processing (summation, multiplication, etc.)
	join -a1 -a2 -e0 -t$'\037' "$2" "$3"
	;;
    scale) #Scale all elements by a constant
	#<constant> <vector>
	echo "scaling"
	;;
    sum) #Element-wise sum
	"$0" join "$2" "$3" | awk -F$'\037' -vOFS=$'\037' '{while (2<NF) {$2+=$NF; NF--}; print}'
	#{for (i=NF-1;2<i;i--) $2+=$i; print $1,$2}
	;;
    help|--help|-h) #Print the list of subcommands or help information for a specific subcommand
	#[subcommand]
	{[[ -z "$2" ]] && echo 'usage: svec <subcommand> [arguments]';
	 grep -A "${+2}" -- "$2.*)\s#" "$0" | sed -nE -e 's/\s*(.+)\)\s#(.+)$/\1 - \2/p' -e "s/^\s*#(.+)/usage: $2 \1/p"} | \
	    sed 's/^\s*//; 2,$ s/^/\t/'	
	;;
    *)
	"$0" help
	;;
esac
